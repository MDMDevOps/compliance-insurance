function gmb_magnific(e,i){"use strict";var a,t=e("form#post"),o=e(".postbox").not(".cmb-row, .cmb-repeatable-grouping"),n=(e("#map"),'<input type="submit" class="button button-primary button-large magnific-submit" id="publish" value="'+gmb_data.i18n.update_map+'">'),s=0,l=e(window).height()-40;i.close_metaboxes=function(e){"google_maps_preview_metabox"===e.attr("id")?e.removeClass("closed"):e.addClass("closed")},i.lightbox_resize=function(){t.addClass("magnific-builder").height(l),e("#map").height(l),e("#postbox-container-1").outerHeight(l)},i.magnific_builder=function(){e.magnificPopup.open({callbacks:{beforeOpen:function(){i.lightbox_resize(),0===e(".magnific-submit").length&&e(".magnific-builder #postbox-container-1").append(n),o.each(function(t,o){var n=e(this),l=n.attr("id");if("undefined"!=typeof l&&l.match(/^\google_maps/)){var r=n.parent();i.close_metaboxes(n),"normal-sortables"==r.attr("id")&&"google_maps_preview_metabox"!==n.attr("id")&&(a="placeholder-"+s++,n.before('<div class="placeholder '+a+'"></div>').appendTo("#side-sortables").data("placeholder",a))}else e(this).addClass("mfp-hide");"undefined"!=typeof e.fn.sortable&&e(".meta-box-sortables").sortable({disabled:!0})})},open:function(){google.maps.event.trigger(window.map,"resize")},resize:function(){e.magnificPopup.instance.isOpen===!0&&i.lightbox_resize()},close:function(){o.removeClass("mfp-hide"),t.removeClass("mfp-hide"),t.removeClass("magnific-builder"),e("#postbox-container-1").outerHeight(""),"undefined"!=typeof e.fn.sortable&&e(".meta-box-sortables").sortable({disabled:!1}),o.each(function(i,a){e(this).appendTo(".placeholder."+e(this).data("placeholder")).unwrap().data("placeholder",void 0)}),google.maps.event.trigger(window.map,"resize")}},items:{src:t,type:"inline"},midClick:!0})},e("#map-builder").on("click",function(e){e.preventDefault(),i.magnific_builder()}),"true"===gmb_data.modal_default&&i.magnific_builder(),e("body").on("click",".magnific-submit",function(i){i.preventDefault(),e("#post_status").val("Publish"),jQuery("#publish").click()}),e("#map-builder").removeClass("disabled")}var gmb_data;window.addEventListener("MapBuilderAdminInit",function(e){gmb_magnific(jQuery,window.MapsBuilderAdmin)});